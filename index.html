<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Counter</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 80px 20px 20px;
    background-color: #f4f4f4;
    color: #333;
  }

  .counter {
    background-color: #2f81e5;
    border: none;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border-radius: 16px; 
    padding: 14px 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: box-shadow 0.3s ease;
    color: #fff;
  }

  .counter:hover {
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }

  .counter.long-press {
    background-color: #2566b6; /* Different background to indicate long press */
  }

  .counter-container {
    text-align: center;
  }

  .counter-name {
    flex-grow: 1;
    text-align: center;
    font-size: 1.3rem;
    margin: 0 10px; 
    -webkit-user-select: none; /* Safari */
    -ms-user-select: none; /* IE 10 and IE 11 */
    user-select: none; /* Standard syntax */
  }

  .counter-value {
    font-size: 2.5rem;
    font-weight: bold;
    -webkit-user-select: none; /* Safari */
    -ms-user-select: none; /* IE 10 and IE 11 */
    user-select: none; /* Standard syntax */
  }

  .btn {
    padding: 5px 10px;
    cursor: pointer;
    border: none;
    background: unset;
    transition: color 0.3s, transform 0.2s; /* Smooth transitions for feedback */
    color: #fff;
    font-size: 4rem;
    font-weight: bold;
    -webkit-user-select: none; /* Safari */
    -ms-user-select: none; /* IE 10 and IE 11 */
    user-select: none; /* Standard syntax */
  }

  .btn:hover {
    color: #a5c7f2;
  }

  /* .btn:active {
    color: #5594e1;
    transform: translateY(2px);
  } */

  #addCounterBtn {
    position: fixed;
    top: 20px;
    right: 20px;
    font-size: 2em;
    cursor: pointer;
  }
</style>
</head>
<body>

<div id="addCounterBtn">+</div>

<script>
  class Counter {
    constructor(name) {
      this.name = name;
      this.value = 0;
    }
  }

  let counters = JSON.parse(localStorage.getItem('counters')) || [];

  function renderCounters() {
    document.body.innerHTML = '<div id="addCounterBtn">+</div>';
    const addButton = document.getElementById('addCounterBtn');
    addButton.addEventListener('click', addCounter);

    counters.forEach((counter, index) => {
      const counterElement = document.createElement('div');
      counterElement.className = 'counter';
      counterElement.innerHTML = `
        <button class="btn" onclick="changeCounterValue(${index}, -1); event.stopPropagation();">-</button>
        <div class="counter-container">
          <div class="counter-name" id="name-${index}">${counter.name}</div>
          <div class="counter-value" id="value-${index}">${counter.value}</div>
        </div>
        <button class="btn" onclick="changeCounterValue(${index}, 1); event.stopPropagation();">+</button>
      `;

      // Setup for detecting long presses on the counter, excluding button presses
      setupLongPressDetection(counterElement, index);
      setupDoubleClickForTitleUpdate(counterElement, index);

      document.body.appendChild(counterElement);
    });
  }

  function setupDoubleClickForTitleUpdate(element, index) {
    element.addEventListener('dblclick', (event) => {
      // Prevent triggering dblclick on buttons
      if (event.target.classList.contains('btn')) return;
      
      // Fetch the current name of the counter to show in the prompt
      const currentName = counters[index].name;
      const newName = prompt('Enter a new name for this counter:', currentName); // Include currentName as the default value in the prompt
      
      if (newName !== null && newName.trim() !== '') {
        counters[index].name = newName.trim();
        document.getElementById(`name-${index}`).textContent = newName;
        updateLocalStorage();
        renderCounters(); // Re-render the counters to reflect the updated name
      }
    });
  }

  function setupLongPressDetection(counterElement, index) {
    let pressTimer;
    counterElement.addEventListener('mousedown', (e) => startPress(index, e));
    counterElement.addEventListener('mouseup', () => stopPress());
    counterElement.addEventListener('mouseleave', () => stopPress()); // Cancel on mouse leave
    counterElement.addEventListener('touchstart', (e) => startPress(index, e));
    counterElement.addEventListener('touchend', () => stopPress());

    function startPress(index, event) {
      if (event.target.classList.contains('btn')) return;
      counterElement.classList.add('long-press');
      pressTimer = window.setTimeout(() => deleteCounter(index, counterElement), 300); // Long press time threshold
    }

    function stopPress() {
      clearTimeout(pressTimer);
      counterElement.classList.remove('long-press'); 
    }
  }

  function addCounter() {
    const name = prompt('Enter the new counter name:');
    if (name) {
      counters.push(new Counter(name));
      updateLocalStorage();
      renderCounters();
    }
  }

  function changeCounterValue(index, delta) {
    counters[index].value += delta;
    document.getElementById(`value-${index}`).innerText = counters[index].value;
    updateLocalStorage();
  }

  function deleteCounter(index, counterElement) {
    counterElement.classList.remove('long-press'); 
    if (confirm('Do you want to delete this counter?')) {
      counters.splice(index, 1);
      updateLocalStorage();
      renderCounters();
    }
  }

  function updateLocalStorage() {
    localStorage.setItem('counters', JSON.stringify(counters));
  }

  renderCounters();
</script>
</body>
</html>
